From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Lovely_xianxian <xyx_dada@outlook.com>
Date: Fri, 5 Aug 2022 21:34:36 +0800
Subject: [PATCH] EventPriority.NEVER


diff --git a/src/main/java/org/bukkit/event/EventPriority.java b/src/main/java/org/bukkit/event/EventPriority.java
index 376c5375df21d59c520c99eb3bc64e9ddae007a6..da9544b7c3ef155855af74695ec04c72004782dc 100644
--- a/src/main/java/org/bukkit/event/EventPriority.java
+++ b/src/main/java/org/bukkit/event/EventPriority.java
@@ -39,7 +39,11 @@ public enum EventPriority {
      * <p>
      * No modifications to the event should be made under this priority
      */
-    MONITOR(5);
+    MONITOR(5),
+    /**
+     * Event will never be called. Used for modified EventPriorities.
+     */
+    NEVER(-100); // Nebula - EventPriority.NEVER
 
     private final int slot;
 
diff --git a/src/main/java/org/bukkit/event/HandlerList.java b/src/main/java/org/bukkit/event/HandlerList.java
index ed78cca71f83b296d082d0af147ca8d622c7606a..780a7d1f58419dc6e4400d1d3210740284e18f5f 100644
--- a/src/main/java/org/bukkit/event/HandlerList.java
+++ b/src/main/java/org/bukkit/event/HandlerList.java
@@ -109,6 +109,8 @@ public class HandlerList {
      * @param listener listener to register
      */
     public synchronized void register(@NotNull RegisteredListener listener) {
+        if(listener.getPriority() == EventPriority.NEVER) // Nebula - EventPriority.NEVER
+            return;
         if (handlerslots.get(listener.getPriority()).contains(listener))
             throw new IllegalStateException("This listener is already registered to priority " + listener.getPriority().toString());
         handlers = null;
diff --git a/src/main/java/org/bukkit/plugin/SimplePluginManager.java b/src/main/java/org/bukkit/plugin/SimplePluginManager.java
index 9db611841b73fed8dc8a71f4d7fdef95af3cf89d..94a0e59815c3615f6881b095b0349f8df36b166e 100644
--- a/src/main/java/org/bukkit/plugin/SimplePluginManager.java
+++ b/src/main/java/org/bukkit/plugin/SimplePluginManager.java
@@ -707,6 +707,8 @@ public final class SimplePluginManager implements PluginManager {
 
     @Override
     public void registerEvent(@NotNull Class<? extends Event> event, @NotNull Listener listener, @NotNull EventPriority priority, @NotNull EventExecutor executor, @NotNull Plugin plugin) {
+        if (priority == EventPriority.NEVER) // Nebula - EventPriority.NEVER
+            return;
         registerEvent(event, listener, priority, executor, plugin, false);
     }
 
