From e7e3acfeea664f4c65f1c408b1c57e44aed6dd03 Mon Sep 17 00:00:00 2001
From: Lovely_xianxian <xyx_dada@outlook.com>
Date: Thu, 30 Jan 2020 21:12:12 +0800
Subject: [PATCH] Load custom language on server startup

---
 src/main/java/net/minecraft/server/DedicatedServer.java | 5 +++++
 src/main/java/xianxian/mc/nebula/NebulaConfig.java      | 2 --
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/main/java/net/minecraft/server/DedicatedServer.java b/src/main/java/net/minecraft/server/DedicatedServer.java
index 9ab0bcd09..2487f1383 100644
--- a/src/main/java/net/minecraft/server/DedicatedServer.java
+++ b/src/main/java/net/minecraft/server/DedicatedServer.java
@@ -35,6 +35,7 @@ import org.apache.logging.log4j.Level;
 import org.bukkit.command.CommandSender;
 import org.bukkit.craftbukkit.LoggerOutputStream;
 import co.aikar.timings.MinecraftTimings; // Paper
+
 import org.bukkit.event.server.ServerCommandEvent;
 import org.bukkit.craftbukkit.util.Waitable;
 import org.bukkit.event.server.RemoteServerCommandEvent;
@@ -203,6 +204,10 @@ public class DedicatedServer extends MinecraftServer implements IMinecraftServer
         }
         xianxian.mc.nebula.NebulaConfig.registerCommands();
         // Nebula end
+        // Nebula start - Load custom language on server startup
+        if (xianxian.mc.nebula.NebulaConfig.useCustomLanguageFile)
+            xianxian.mc.nebula.CustomLocaleLanguage.getInstance().load(xianxian.mc.nebula.NebulaConfig.customLanguageFilePath);
+        // Nebula end
         this.setSpawnAnimals(dedicatedserverproperties.spawnAnimals);
         this.setSpawnNPCs(dedicatedserverproperties.spawnNpcs);
         this.setPVP(dedicatedserverproperties.pvp);
diff --git a/src/main/java/xianxian/mc/nebula/NebulaConfig.java b/src/main/java/xianxian/mc/nebula/NebulaConfig.java
index 3b6792e65..6425f6e9f 100644
--- a/src/main/java/xianxian/mc/nebula/NebulaConfig.java
+++ b/src/main/java/xianxian/mc/nebula/NebulaConfig.java
@@ -185,8 +185,6 @@ public class NebulaConfig {
     public static String customLanguageFilePath = "custom-language.json";
     private static void customLanguageFilePath() {
     	customLanguageFilePath = getString("settings.custom-language-file-path", "custom-language.json");
-    	if (useCustomLanguageFile)
-    		CustomLocaleLanguage.getInstance().load(customLanguageFilePath);
     }
     
     public static String beesInsideLore = "%d Bee(s) inside";
-- 
2.25.0

